CREATE TABLE  "TLOGIN" 
   (	"USER_ID" NUMBER(*,0), 
	"FULL_NAME" VARCHAR2(255) NOT NULL ENABLE, 
	"USERNAME" VARCHAR2(255) NOT NULL ENABLE, 
	"PASSWORD" VARCHAR2(255) NOT NULL ENABLE, 
	"EMAIL" VARCHAR2(255) NOT NULL ENABLE, 
	"PHONE_NUMBER" VARCHAR2(255) NOT NULL ENABLE, 
	"ADDRESS" VARCHAR2(255) NOT NULL ENABLE, 
	"GENDER" VARCHAR2(255) NOT NULL ENABLE, 
	"SECURITYQ" VARCHAR2(255) NOT NULL ENABLE, 
	"ANSWER" VARCHAR2(255) NOT NULL ENABLE, 
	 PRIMARY KEY ("USER_ID") ENABLE, 
	 UNIQUE ("USERNAME") ENABLE
   ) ;
   
   CREATE TABLE  "TRAIN" 
   (	"TRAIN_NO" NUMBER(5,0) NOT NULL ENABLE, 
	"TRAIN_NAME" VARCHAR2(100) NOT NULL ENABLE, 
	"SOURCE_STATION" VARCHAR2(100) NOT NULL ENABLE, 
	"DESTINATION_STATION" VARCHAR2(100) NOT NULL ENABLE, 
	"DEPARTURE_TIME" VARCHAR2(100), 
	"ARRIVAL_TIME" VARCHAR2(100), 
	"FARE" VARCHAR2(100), 
	"TOTAL_DISTANCE" VARCHAR2(100), 
	 CONSTRAINT "TRAIN_PK" PRIMARY KEY ("TRAIN_NO") ENABLE
   ) ;
   
   CREATE TABLE  "BOOKINGS" 
   (	"PNR_NUMBER" NUMBER(10,0) NOT NULL ENABLE, 
	"TRAIN_NO" NUMBER(5,0) NOT NULL ENABLE, 
	"CLASS_TYPE" VARCHAR2(100) NOT NULL ENABLE, 
	"NUMSEATS" NUMBER(10,0) NOT NULL ENABLE, 
	"USER_ID" NUMBER NOT NULL ENABLE, 
	"DOJ" VARCHAR2(100), 
	"TOTAL_FARE" NUMBER(10,2), 
	 CONSTRAINT "BOOKINGS_PK" PRIMARY KEY ("PNR_NUMBER") ENABLE
   ) ;
   
   CREATE TABLE  "CANCEL" 
   (	"PNR_NUMBER" NUMBER(10,0) NOT NULL ENABLE, 
	"TRAIN_NO" NUMBER(5,0) NOT NULL ENABLE, 
	"CLASS_TYPE" VARCHAR2(100) NOT NULL ENABLE, 
	"NUMSEATS" NUMBER(10,0) NOT NULL ENABLE, 
	"USER_ID" NUMBER NOT NULL ENABLE, 
	"DOJ" VARCHAR2(100) NOT NULL ENABLE, 
	"TOTAL_FARE" NUMBER(10,2) NOT NULL ENABLE, 
	 CONSTRAINT "PK_CONSTRAINT_NAME" PRIMARY KEY ("PNR_NUMBER") ENABLE
   ) ;
   
   ALTER TABLE  "BOOKINGS" ADD CONSTRAINT "BOOKINGS_FK" FOREIGN KEY ("TRAIN_NO")
	  REFERENCES  "TRAIN" ("TRAIN_NO") ENABLE;ALTER TABLE  "BOOKINGS" ADD CONSTRAINT "BOOKINGS_FK2" FOREIGN KEY ("USER_ID")
	  REFERENCES  "TLOGIN" ("USER_ID") ENABLE;
	  
CREATE SEQUENCE   "USER_BI"  MINVALUE 1 MAXVALUE 9999999999999999999999999999 INCREMENT BY 1 START WITH 61 CACHE 20 NOORDER  NOCYCLE ; CREATE SEQUENCE   "TRAIN_SEQ"  MINVALUE 1 MAXVALUE 9999999999999999999999999999 INCREMENT BY 1 START WITH 21 CACHE 20 NOORDER  NOCYCLE ; CREATE SEQUENCE   "PNR_NUMBER_SEQ"  MINVALUE 1 MAXVALUE 9999999999999999999999999999 INCREMENT BY 1 START WITH 100000020 CACHE 20 NOORDER  NOCYCLE ; CREATE SEQUENCE   "CANCEL_SEQ"  MINVALUE 1 MAXVALUE 9999999999999999999999999999 INCREMENT BY 1 START WITH 1 CACHE 20 NOORDER  NOCYCLE ; CREATE SEQUENCE   "BOOKINGS_SEQ"  MINVALUE 1000000000 MAXVALUE 9999999999 INCREMENT BY 1 START WITH 1000000040 CACHE 20 NOORDER  NOCYCLE ;

CREATE OR REPLACE TRIGGER  "TLOGIN_BI" 
BEFORE INSERT ON TLOGIN
FOR EACH ROW
BEGIN
    SELECT USER_BI.nextval
    INTO :new.USER_ID
    FROM dual;
END;
/

ALTER TRIGGER  "TLOGIN_BI" ENABLE;CREATE OR REPLACE TRIGGER  "BI_BOOKINGS" 
BEFORE INSERT ON BOOKINGS
FOR EACH ROW
BEGIN
    SELECT BOOKINGS_SEQ.nextval
    INTO :new.PNR_NUMBER
    FROM dual;
END; 

/
ALTER TRIGGER  "BI_BOOKINGS" ENABLE;
